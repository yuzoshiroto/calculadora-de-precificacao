<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Precifica√ß√£o | Duo Academy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Adiciona a biblioteca de √≠cones Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Painel Lateral de Par√¢metros -->
        <aside class="sidebar">
            <button type="button" id="sidebar-toggle-btn" class="sidebar-toggle-btn" title="Recolher/Expandir">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="sidebar-content-wrapper">
                <div class="logo">
                    <img src="https://i.imgur.com/r6b3p1B.png" alt="Logo DUO">
                </div>
                <div class="sidebar-sticky-content">
                    <form id="params-form">
                        <h3>
                            <span><i class="icon">üìä</i>Par√¢metros Globais</span>
                            <div class="info-tooltip">
                                <i class="info-icon">i</i>
                                <span class="tooltip-text">Defina os par√¢metros base usados para o c√°lculo de todos os servi√ßos.</span>
                            </div>
                        </h3>
                        <div class="param-group" id="financial-params">
                            <!-- Par√¢metros Financeiros ser√£o inseridos aqui pelo JS -->
                        </div>
                        
                        <h3>
                            <span><i class="icon">‚úÇÔ∏è</i>Adicionar Servi√ßos</span>
                            <div class="info-tooltip">
                                <i class="info-icon">i</i>
                                <span class="tooltip-text">Adicione os servi√ßos que deseja analisar a precifica√ß√£o.</span>
                            </div>
                        </h3>
                        <div class="param-group" id="service-manager">
                             <div class="form-field">
                                <label for="new-service-name">Nome do servi√ßo</label>
                                <input type="text" id="new-service-name" placeholder="Ex: Corte Feminino">
                             </div>
                             <div class="form-field">
                                <label for="new-service-price">Pre√ßo atual (R$)</label>
                                <input type="text" id="new-service-price" class="formatted-number-input" placeholder="Ex: 55,00" data-raw-value="0">
                             </div>
                             <div class="form-field">
                                <label for="new-service-admin-fee">Taxa administrativa (%)</label>
                                <input type="number" id="new-service-admin-fee" placeholder="Ex: 10" step="0.01" min="0">
                             </div>
                             <div class="form-field">
                                 <label for="new-service-product-origin">Custo de produto (R$)</label>
                                <select id="new-service-product-origin">
                                    <option value="" selected disabled>Selecione uma op√ß√£o...</option>
                                    <option value="salon">Produto do Sal√£o</option>
                                    <option value="professional">Produto do Profissional</option>
                                    <option value="client">Produto do Cliente</option>
                                </select>
                             </div>
                             <div class="form-field" id="new-service-cost-container">
                                <input type="text" id="new-service-cost" class="formatted-number-input" placeholder="Ex: 2,00" data-raw-value="0">
                             </div>
                             <div class="form-field">
                                <label for="new-service-commission">Comiss√£o (%)</label>
                                <input type="number" id="new-service-commission" placeholder="Ex: 50" step="0.01" min="0">
                             </div>
                             <button type="button" id="add-service-btn">Adicionar Servi√ßo</button>
                        </div>
                    </form>
                </div>
                 <div class="sidebar-footer">
                    <p>Dados salvos localmente.</p>
                </div>
            </div>
        </aside>

        <!-- Conte√∫do Principal -->
        <main class="main-content">
            <header>
                <div class="header-content-wrapper">
                    <div class="header-text">
                        <h1>Dashboard de Precifica√ß√£o</h1>
                        <p>por Duo Academy</p>
                    </div>
                    <div class="header-buttons-group">
                        <a href="fixed_cost_calculator.html" class="header-tab-button">
                            <i class="fas fa-building"></i> Calculadora de Custo Fixo/Vari√°vel
                        </a>
                        <a href="product_cost_calculator.html" class="header-tab-button">
                            <i class="fas fa-calculator"></i> Calculadora de Custo de Produto
                        </a>
                    </div>
                </div>
            </header>

            <!-- Se√ß√£o de Resumo e Gr√°fico -->
            <section class="dashboard-summary" id="dashboard-summary">
                <div class="service-details">
                    <h2 id="selected-service-name">Selecione um servi√ßo na tabela</h2>
                    <div class="details-grid">
                        <div class="detail-card">
                            <h4>Pre√ßo Atual</h4>
                            <span id="details-price">R$ 0,00</span>
                        </div>
                        <div class="detail-card">
                            <h4>Custo do Produto</h4>
                            <span id="details-product-cost">R$ 0,00</span>
                        </div>
                        <div class="detail-card">
                            <h4>Comiss√£o %</h4>
                            <span id="details-commission-percent">0,00%</span>
                        </div>
                        <div class="detail-card">
                            <h4 class="admin-fee-label-full">Taxa Administrativa %</h4>
                            <h4 class="admin-fee-label-short">Taxa Admin. %</h4>
                            <span id="details-admin-fee-percent">0,00%</span>
                        </div>
                        <div class="detail-card">
                            <h4>Valor Comiss√£o</h4>
                            <span id="details-commission-value">R$ 0,00</span>
                        </div>
                        <div class="detail-card">
                            <h4>Pre√ßo Sugerido</h4>
                            <span id="details-suggested-price">R$ 0,00</span>
                        </div>
                         <div class="detail-card">
                            <h4>Lucro R$</h4>
                            <span id="details-profit-value">R$ 0,00</span>
                        </div>
                        <div class="detail-card">
                            <h4>Lucro %</h4>
                            <span id="details-profit-percent">0,00%</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Novas Se√ß√µes: Detalhamento e Dicas (Inspirado na Calculadora da Dani) -->
            <section class="analysis-section" id="analysis-section" style="display: none;">
                <!-- Detalhamento do Pre√ßo -->
                <div class="breakdown-card">
                    <div class="breakdown-header">
                        <h3 id="breakdown-title"><i class="icon">üß©</i> Detalhamento do Pre√ßo</h3>
                        <p class="breakdown-subtitle">Entenda para onde vai cada centavo do pre√ßo do servi√ßo.</p>
                    </div>
                    <div class="breakdown-body">
                        <div class="breakdown-details">
                            <div class="breakdown-summary">
                                <div class="summary-label">Total (Pre√ßo Atual)</div>
                                <div class="summary-value" id="breakdown-total">R$ 0,00</div>
                            </div>
                            <div class="breakdown-container">
                                <div class="breakdown-item" id="breakdown-commission">
                                    <div class="breakdown-label"><i class="icon">ü§ù</i>Comiss√£o</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-marketing">
                                    <div class="breakdown-label"><i class="icon">üì¢</i>Marketing</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-tax">
                                    <div class="breakdown-label"><i class="icon">üìú</i>Impostos</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-card-fee">
                                    <div class="breakdown-label"><i class="icon">üí≥</i>Taxa de Cart√£o</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-fixed-cost">
                                    <div class="breakdown-label"><i class="icon">üè¢</i>Custos Fixos</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-product-cost">
                                    <div class="breakdown-label"><i class="icon">üß¥</i>Custo do Produto</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item breakdown-total-costs" id="breakdown-total-costs">
                                    <div class="breakdown-label">Total de Custos</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                                <div class="breakdown-item" id="breakdown-profit">
                                    <div class="breakdown-label"><i class="icon">üíµ</i>Lucro Real</div>
                                    <div class="breakdown-value"><span class="value-real">R$ 0,00</span><span class="value-percent">(0,00%)</span></div>
                                </div>
                            </div>
                        </div>
                        <div class="breakdown-chart-container">
                            <canvas id="breakdown-chart"></canvas>
                            <div id="breakdown-chart-center-text" class="chart-center-text">
                                <!-- O valor ser√° inserido aqui pelo JS -->
                            </div>
                            <!-- Novo container para a informa√ß√£o de economia -->
                            <div id="chart-savings-info" class="chart-savings-info">
                                <!-- O texto de economia ser√° inserido aqui pelo JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dicas de An√°lise -->
                <div class="analysis-tips">
                    <div class="analysis-tips-header">
                        <h3><i class="icon">üí°</i> An√°lise do servi√ßo</h3>
                        <p class="analysis-subtitle">Dicas para otimizar sua precifica√ß√£o.</p>
                    </div>
                    <div id="tips-content" class="tips-content">
                        <!-- Dicas ser√£o inseridas aqui pelo JS -->
                    </div>
                </div>
            </section>

            <!-- Tabela de Precifica√ß√£o -->
            <section class="pricing-table-container">
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th class="service-header">
                                    <div class="service-header-content">
                                        <div class="header-content">
                                            <span>Servi√ßo</span>
                                        </div>
                                        <div class="search-wrapper">
                                            <input type="text" id="service-search-input" placeholder="Pesquisar servi√ßo...">
                                            <button type="button" id="clear-search-btn" class="clear-search-btn" title="Limpar busca">√ó</button>
                                        </div>
                                    </div>
                                </th>
                                <th class="editable-header">
                                    <div class="header-content">
                                        <span>Pre√ßo Atual</span>
                                        <div class="sort-icons" data-sort-by="currentPrice"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Custo de Produto</span>
                                        <div class="sort-icons" data-sort-by="productCost"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Comiss√£o</span>
                                        <div class="sort-icons" data-sort-by="commission"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Taxa Admin.</span>
                                        <div class="sort-icons" data-sort-by="adminFee"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Valor Comiss√£o</span>
                                        <div class="sort-icons" data-sort-by="commissionValue"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Pre√ßo Sugerido</span>
                                        <div class="sort-icons" data-sort-by="suggestedPrice"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Lucro R$</span>
                                        <div class="sort-icons" data-sort-by="financialProfit"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>
                                    <div class="header-content">
                                        <span>Lucro %</span>
                                        <div class="sort-icons" data-sort-by="profitPercentage"><span class="sort-icon"></span></div>
                                    </div>
                                </th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="pricing-table-body">
                            <!-- Linhas da tabela ser√£o inseridas aqui pelo JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Cards de M√©tricas Gerais (Agora abaixo da tabela) -->
            <section class="metrics-cards">
                <div class="metric-card multi-info-card">
                    <h3>Resumo Geral</h3>
                    <div class="multi-info-content">
                        <div class="info-line"><span>Total de Servi√ßos</span><strong id="total-services-metric">0</strong></div>
                        <div class="info-line"><span>Custo M√©dio</span><strong id="avg-product-cost-metric">R$ 0,00</strong></div>
                        <div class="info-line"><span>Comiss√£o M√©dia</span><strong id="avg-commission-metric">0,00%</strong></div>
                        <div class="info-line"><span>Lucro M√©dio</span><strong id="avg-profit-metric">0,00%</strong></div>
                    </div>
                </div>
                <div class="metric-card salao-parceiro-card">
                    <h3><i class="icon">ü§ù</i> Lei do Sal√£o Parceiro</h3>
                    <p id="salao-parceiro-metric"></p>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal para Edi√ß√£o de Custo de Produto -->
    <div id="product-cost-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3><i class="icon">üß¥</i> Configurar Custo de Produto</h3>
            <p class="modal-subtitle">Ajuste a origem e o valor do produto para o servi√ßo selecionado.</p>
            
            <div class="form-field">
                <label for="modal-product-origin">Custo de produto (R$)</label>
                <select id="modal-product-origin">
                    <option value="" selected disabled>Selecione uma op√ß√£o...</option>
                    <option value="salon">Produto do Sal√£o</option>
                    <option value="professional">Produto do Profissional</option>
                    <option value="client">Produto do Cliente</option>
                </select>
            </div>
            <div class="form-field with-side-button" id="modal-cost-container">
                <input type="text" id="modal-product-cost" class="formatted-number-input" placeholder="Ex: 2,00" data-raw-value="0">
                <a href="#" id="modal-calculator-btn" class="side-btn">
                    <i class="fas fa-calculator"></i> Calculadora
                </a>
            </div>

            <div class="modal-actions">
                <button type="button" id="modal-cancel-btn" class="modal-btn-secondary">Cancelar</button>
                <button type="button" id="modal-save-btn" class="modal-btn-primary">Salvar Altera√ß√µes</button>
            </div>
        </div>
    </div>

    <!-- Biblioteca de Gr√°ficos Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Nosso script principal -->
    <script src="script.js"></script>
</body>
</html>